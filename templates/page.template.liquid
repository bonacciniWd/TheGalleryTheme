<!-- Remove o layout padr√£o do tema -->

<!doctype html>
<html>
  <head>
    <title>Amaterasu rescue</title>
    <link rel="stylesheet" href="{{ 'game.css' | asset_url }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  </head>
  <body>
    <!-- Tela de hist√≥ria introdut√≥ria -->
    <div id="story-screen">
      <div class="story-container">
        <h1>Amate Ninja</h1>
        <div id="story-text"></div>
        <button id="skip-story">Pular</button>
        <button id="continue-story">Continuar</button>
      </div>
    </div>

    <!-- Tela do jogo -->
    <div class="container" style="display: none;">
      <canvas id="game"></canvas>
      <div id="score" unselectable="on">0</div>
      <div id="introduction" unselectable="on">Segure o bot√£o do mouse para esticar o bast√£o</div>
      <div id="perfect" unselectable="on">PERFECT üßô</div>
      <button id="mobileStartButton" style="display: none;">Tocar para iniciar</button>
    </div>

    <!-- Adicionar elementos de √°udio -->
    <audio id="backgroundMusic" loop>
      <source src="https://assets.codepen.io/21542/howling-wind.mp3" type="audio/mp3">
    </audio>
    <audio id="perfectSound">
      <source src="https://assets.codepen.io/21542/click.mp3" type="audio/mp3">
    </audio>
    <audio id="fallSound">
      <source src="https://assets.codepen.io/21542/fall.mp3" type="audio/mp3">
    </audio>

    <div id="creditos" unselectable="on">
      <span>Powered by Vrz Studio</span>
    </div>
    <div id="touchArea"></div>
    <button id="restart">REINICIAR</button>
    <script>
      // Garantir que o jogo seja carregado corretamente
      window.addEventListener('pageshow', function(event) {
        // Se a p√°gina est√° sendo carregada a partir do cache do navegador
        if (event.persisted) {
          // Recarregar a p√°gina para evitar problemas de branco
          window.location.reload();
        }
      });

      // Prevenir sele√ß√£o de texto em toda a p√°gina
      document.addEventListener('touchstart', function(e) {
        // Permitir eventos normais em bot√µes
        if (e.target.tagName !== 'BUTTON') {
          e.preventDefault();
        }
      }, { passive: false });

      // Hist√≥ria dividida em par√°grafos para exibi√ß√£o gradual
      const storyParagraphs = [
        "Em um Jap√£o ancestral coberto por sombras e trai√ß√µes, o lend√°rio Cl√£ Amaterasu protegia os segredos da luz celestial ‚Äî a for√ßa capaz de manter o equil√≠brio entre o mundo dos vivos e o reino dos esp√≠ritos.",
        "Por s√©culos, os Amaterasu viveram nas montanhas sagradas, ocultos dos olhos mortais. At√© que uma noite, o impiedoso Senhor Kurojin, mestre das artes obscuras, invadiu o santu√°rio e capturou os anci√£os do cl√£, roubando o pergaminho da Luz Eterna.",
        "Com o mundo mergulhando lentamente na escurid√£o, a √∫ltima esperan√ßa recai sobre um pequeno grupo de jovens ninjas sobreviventes. √Ågeis, leais e determinados, eles agora devem atravessar territ√≥rios inimigos, enfrentar criaturas das trevas e resgatar seus mestres antes que a luz se apague para sempre.",
        "O destino do cl√£... e do mundo... est√° em suas m√£os."
      ];

      let currentParagraph = 0;
      const storyTextElement = document.getElementById('story-text');
      const continueButton = document.getElementById('continue-story');
      const skipButton = document.getElementById('skip-story');

      // Fun√ß√£o para criar efeito de digita√ß√£o
      function typeWriter(text, element, speed = 30) {
        let i = 0;
        element.textContent = '';
        continueButton.disabled = true;

        function type() {
          if (i < text.length) {
            element.textContent += text.charAt(i);
            i++;
            setTimeout(type, speed);
          } else {
            continueButton.disabled = false;
          }
        }

        type();
      }

      // Exibir o primeiro par√°grafo com efeito de digita√ß√£o
      typeWriter(storyParagraphs[currentParagraph], storyTextElement);

      // Bot√£o de continuar para avan√ßar na hist√≥ria
      continueButton.addEventListener('click', function() {
        currentParagraph++;
        if (currentParagraph < storyParagraphs.length) {
          typeWriter(storyParagraphs[currentParagraph], storyTextElement);
        } else {
          startGame();
        }
      });

      // Bot√£o para pular a hist√≥ria e ir direto para o jogo
      skipButton.addEventListener('click', function() {
        startGame();
      });

      // Fun√ß√£o para iniciar o jogo
      function startGame() {
        document.getElementById('story-screen').style.display = 'none';
        document.querySelector('.container').style.display = 'flex';

        // Disparar evento para inicializar o jogo
        const gameStartEvent = new Event('gameStartFromStory');
        window.dispatchEvent(gameStartEvent);
      }
    </script>
    <script src="{{ 'game.js' | asset_url }}" defer></script>
  </body>
</html>
