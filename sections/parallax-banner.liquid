{% comment %}
  Seção de Parallax Personalizada para Shopify
  Este arquivo Liquid cria uma seção de parallax configurável no editor de temas.
  Permite definir imagem de fundo, texto, botão e velocidade do parallax.
{% endcomment %}

<style>
  /* Estilos essenciais para a seção parallax */
  .parallax-section-{{ section.id }} {
    position: relative;
    height: {{ section.settings.section_height }}vh; /* Altura da seção em VH (Viewport Height) */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden; /* Garante que o conteúdo não vaze */
    text-align: center;
    background-color: {{ section.settings.background_color }}; /* Cor de fundo da seção */
  }

  .parallax-bg-{{ section.id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    z-index: -1; /* Coloca o fundo atrás do conteúdo */
    will-change: transform; /* Otimização para animação */
    /* Fallback para imagem de fundo caso a definida no schema não carregue */
    background-image: url('{{ section.settings.background_image | img_url: 'master' }}');
    background-image: -webkit-image-set(
      url('{{ section.settings.background_image | img_url: 'master' }}') 1x,
      url('{{ section.settings.background_image | img_url: '2x' }}') 2x
    );
    background-repeat: no-repeat;
  }

  .parallax-content-{{ section.id }} {
    position: relative;
    z-index: 1;
    padding: 2rem;
    max-width: 90%;
    /* Fundo semi-transparente para melhor legibilidade do texto */
    background-color: {{ section.settings.content_bg_color }};
    border-radius: 1rem;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
  }

  /* Estilos para o texto */
  .parallax-content-{{ section.id }} h1,
  .parallax-content-{{ section.id }} h2 {
    color: {{ section.settings.heading_color }};
    font-family: 'Inter', sans-serif; /* Usando a fonte Inter */
  }

  .parallax-content-{{ section.id }} p {
    color: {{ section.settings.subheading_color }};
    font-family: 'Inter', sans-serif; /* Usando a fonte Inter */
  }

  /* Efeito de desvanecimento para o conteúdo */
  .fade-element-{{ section.id }} {
      opacity: 0;
      transition: opacity 0.5s ease-out;
  }

  .fade-element-{{ section.id }}.is-visible {
      opacity: 1;
  }

  /* Estilos para o botão (usando classes Tailwind para flexibilidade) */
  .btn-primary-{{ section.id }} {
      display: inline-block;
      padding: 1rem 2rem; /* px-8 py-3 */
      margin-top: 1.5rem; /* mt-6 */
      font-size: 1.125rem; /* text-lg */
      font-weight: 600; /* font-semibold */
      color: {{ section.settings.button_text_color }};
      background-color: {{ section.settings.button_bg_color }};
      border-radius: 9999px; /* rounded-full */
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
      transition: background-color 0.3s ease-in-out, transform 0.3s ease-in-out;
      text-decoration: none;
  }

  .btn-primary-{{ section.id }}:hover {
      background-color: {{ section.settings.button_hover_bg_color }};
      transform: scale(1.05);
  }

  /* Responsividade básica */
  @media (min-width: 768px) { /* md breakpoint */
    .parallax-section-{{ section.id }} h1 {
      font-size: 4.5rem; /* md:text-7xl */
    }
    .parallax-section-{{ section.id }} p {
      font-size: 1.5rem; /* md:text-2xl */
    }
  }
</style>

<section class="parallax-section-{{ section.id }}">
  <div class="parallax-bg-{{ section.id }}"
       data-parallax-speed="{{ section.settings.parallax_speed }}">
  </div>
  <div class="parallax-content-{{ section.id }}">
    {% if section.settings.heading != blank %}
      <h1 class="text-5xl font-bold mb-4 fade-element-{{ section.id }}">{{ section.settings.heading }}</h1>
    {% endif %}
    {% if section.settings.subheading != blank %}
      <p class="text-xl mb-8 fade-element-{{ section.id }}">{{ section.settings.subheading }}</p>
    {% endif %}
    {% if section.settings.button_text != blank and section.settings.button_url != blank %}
      <a href="{{ section.settings.button_url }}" class="btn-primary-{{ section.id }} fade-element-{{ section.id }}">
        {{ section.settings.button_text }}
      </a>
    {% endif %}
  </div>
</section>

<script>
  // Script para a seção parallax específica (usando o ID da seção para evitar conflitos)
  document.addEventListener('DOMContentLoaded', function() {
    const sectionElement = document.querySelector('.parallax-section-{{ section.id }}');
    const parallaxBg = sectionElement.querySelector('.parallax-bg-{{ section.id }}');
    const parallaxContent = sectionElement.querySelector('.parallax-content-{{ section.id }}');
    const fadeElements = sectionElement.querySelectorAll('.fade-element-{{ section.id }}');

    const parallaxSpeed = parseFloat(parallaxBg.dataset.parallaxSpeed);

    function applyParallax() {
      const scrollPosition = window.pageYOffset;
      const sectionTop = sectionElement.offsetTop;
      const sectionHeight = sectionElement.offsetHeight;
      const windowHeight = window.innerHeight;

      // Parallax para o fundo
      const yPos = -(scrollPosition * parallaxSpeed);
      parallaxBg.style.transform = `translateY(${yPos}px)`;

      // Efeito de desvanecimento para o conteúdo
      const visibilityThreshold = 0.5; // A seção está visível se pelo menos 50% dela estiver na tela
      const isVisible = (scrollPosition + windowHeight * visibilityThreshold > sectionTop) &&
                        (scrollPosition < sectionTop + sectionHeight * (1 - visibilityThreshold));

      fadeElements.forEach(el => {
        if (isVisible) {
          el.classList.add('is-visible');
        } else {
          el.classList.remove('is-visible');
        }
      });
    }

    // Adiciona listener de rolagem e chama a função no carregamento
    window.addEventListener('scroll', applyParallax);
    window.addEventListener('load', applyParallax);

    // Chama a função uma vez para garantir o estado inicial correto
    applyParallax();
  });
</script>


{% schema %}
{
  "name": "Parallax Personalizado",
  "settings": [
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Imagem de Fundo",
      "info": "Escolha uma imagem para o fundo da seção parallax."
    },
    {
      "type": "range",
      "id": "parallax_speed",
      "min": 0.0,
      "max": 1.0,
      "step": 0.1,
      "unit": "x",
      "label": "Velocidade do Parallax",
      "default": 0.3,
      "info": "Controla a velocidade de rolagem da imagem de fundo (0 = parado, 1 = velocidade normal)."
    },
    {
      "type": "range",
      "id": "section_height",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "vh",
      "label": "Altura da Seção",
      "default": 100,
      "info": "Altura da seção em relação à altura da tela (viewport height)."
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Cor de Fundo da Seção",
      "default": "#f5f5f7"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Título",
      "default": "Descubra o Futuro"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Cor do Título",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subtítulo",
      "default": "Tecnologia inovadora ao seu alcance."
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Cor do Subtítulo",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "content_bg_color",
      "label": "Cor de Fundo do Conteúdo",
      "default": "rgba(0,0,0,0.4)",
      "info": "Fundo semi-transparente para o bloco de texto."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Texto do Botão",
      "default": "Saiba Mais"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Link do Botão",
      "default": "/collections/all"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Cor de Fundo do Botão",
      "default": "#007aff"
    },
    {
      "type": "color",
      "id": "button_hover_bg_color",
      "label": "Cor de Fundo do Botão (Hover)",
      "default": "#005bb5"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Cor do Texto do Botão",
      "default": "#ffffff"
    }
  ],
  "presets": [
    {
      "name": "Parallax Personalizado",
      "category": "Imagens e Vídeos"
    }
  ]
}
{% endschema %}